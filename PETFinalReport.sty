% Package for creating final year reports for School of PET
% By Jacqueline Walker, Licensed under the Mozilla MPLv2
% 2024/02/18
\ProvidesPackage{PETFinalReport}[2024/02/18 UoY School of PET Final Year Report]

% Required packages
\RequirePackage{graphicx}
\RequirePackage{fancyhdr}
\RequirePackage{titlesec}
\RequirePackage[a4paper, margin=2cm]{geometry}

% Custom commands for titlepage fields
\newcommand*{\project}[1]{\gdef\@project{#1}}
\newcommand*{\module}[1]{\gdef\@module{#1}}
\newcommand*{\supervisor}[1]{\gdef\@supervisor{#1}}
\newcommand*{\college}[1]{\gdef\@college{#1}}

% Custom titlepage to adhere to given example titlepage
\renewcommand*{\maketitle}{%
\begin{titlepage}
	\centering
        {\textbf{\Huge\@project}\par}
        {\Large\@title\par}
        \vspace{1cm}
        {\textsc{\large\@module}\par}
        \vspace{4cm}
        \IfFileExists{logo.pdf}{\includegraphics[scale=0.4]{logo.pdf}}{}
        \vfill{}
        {\large\@author\par}
        \vspace{4cm}
        {\textbf{\large Supervisors }\par}
        {\large\@supervisor\par}
        \vspace{2cm}
        {\normalsize\@college\par}
        {\normalsize University of York \par}
        {\small \@date \par}
\end{titlepage}
}

% Custom chapter title commands, default is left justified
\newcommand{\frcentertitle}{%
    \titleformat{\chapter}[block]
    {\centering\Large\bfseries}{\thechapter}{1em}{\huge}
\titlespacing*{\chapter}{0pt}{-19pt}{20pt}

}

\newcommand{\frlefttitle}{%
    \titleformat{\chapter}[block]
    {\Large\bfseries}{\thechapter}{1em}{\huge}
\titlespacing*{\chapter}{0pt}{-19pt}{20pt}
        
}

% Custom page headers and footers
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\pagestyle{fancy}
\fancyhf{}

\makeatletter
\fancyhead[L]{\textsc{\textbf{\@project}}\\\textsc{\small \@title}}
\fancyhead[R]{\textsc{\leftmark}\\}
\fancyfoot[C]{\thepage}
\makeatother

% Custom abstract formatting
\newenvironment{frabstract}
    {\frcentertitle
    \chapter*{Abstract}
    \addcontentsline{toc}{chapter}{Abstract}
    \begin{center}\begin{minipage}{0.8\linewidth}
    }
    {\end{minipage}\end{center}\frlefttitle}

\newcommand{\frreferences}
    {\frcentertitle\chapter*{References}
    \addcontentsline{toc}{chapter}{References}
    \printbibliography[heading=none]\frlefttitle}

\frlefttitle

\endinput
